pico-8 cartridge // http://www.pico-8.com
version 42
__lua__
-- reprite entities
function ssprc(sx,sy,sw,sh,dx,dy,dw,dh,fx,fy,a,oc)
    local dw=dw or sw
    local dh=dh or sh
    local a = a or 'cb' --alignment
    local x,y=sx,sy
    if a=='cb' then
        x=sx+dw/2
        y=sy-dh
    end

    for i=1,15 do
        pal(i,1)
    end

    sspr(sx,sy,sw,sh,dx-1,dy,dw,dh,fx,fy)
    sspr(sx,sy,sw,sh,dx+1,dy,dw,dh,fx,fy)
    sspr(sx,sy,sw,sh,dx,dy-1,dw,dh,fx,fy)
    sspr(sx,sy,sw,sh,dx,dy+1,dw,dh,fx,fy)
    pal()

    sspr(sx,sy,sw,sh,dx,dy,dw,dh,fx,fy)
end

function _init()
    p = {
        x=64,y=64,
        state='idle',
        a={
            idle={s=.1,f={{16,0,9,16,false},{25,0,9,16,false},{34,0,10,16,false},{44,0,9,16,false}}},
            walk_r={s=.3,f={{53,0,9,16,false},{62,0,10,16,false},{72,0,9,16,false},{81,0,9,16,false},{90,0,10,16,false},{100,0,9,16,false}}},
            walk_l={s=.3,f={{53,0,9,16,true},{62,0,10,16,true},{72,0,9,16,true},{81,0,9,16,true},{90,0,10,16,true},{100,0,9,16,true}}},
        },
        ai=1,
        update=function(s)
            local ca=s.a[s.state]
            s.ai+=ca.s
            if(s.ai>=#ca.f+1)s.ai=1
            local new_state=s.state
            if btn(➡️) then
                new_state='walk_r'
            elseif btn(⬅️) then
                new_state='walk_l'
            else
                new_state='idle'
            end
            if(new_state!=s.state)s.ai=1
            s.state=new_state
        end,
        draw=function(s)
            local ca=s.a[s.state]
            local frame=ca.f[flr(s.ai)]
            

            ssprc(frame[1],frame[2],frame[3],frame[4],s.x,s.y,frame[3]*2,frame[4]*2,frame[5])

            print(s.ai,s.x,s.y-10)
            pset(s.x,s.y,8)
        end
    }
end
function _update()
    p:update()
end

function _draw()
    cls()
    p:draw()
end
__gfx__
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000999999009
00000000000000000000000000000000000000000000000000000000000000000000000009999990900000000000000000000999999090000000000999999990
0070070000000000099999909000000000099999900009999990900000000009999990090999999990000000000999999009099999999000000000999ffff900
000770000000000009999999909999990909999999090999999990999999090999999990999ffff900999999090999999990999ffff9000000000099ffffff00
0007700000000000999ffff90099999999999ffff990999ffff90099999999999ffff90099ffffff0099999999999ffff90099ffffff0099999909f9f73f73f0
007007000000000099ffffff0999ffff9099ffffff0099ffffff0999ffff9099ffffff00f9f73f73f999ffff9099ffffff00f9f73f73f099999999fffffffff0
0000000000000000f9f73f73f99ffffff0f9f73f73f0f9f73f73f99ffffff0f9f73f73f0fffffffff99ffffff0f9f73f73f0fffffffff999ffff900fff77ff04
0000000000000000ffffffffff9f73f73ffffffffff0ffffffffff9f73f73ffffffffff00fff77ff0f9f73f73ffffffffff00fff77ff099ffffff000fffff447
00000000000000000fff77ff0fffffffff0fff77ff000fff77ff0fffffffff0fff77ff0000fffff00fffffffff0fff77ff0000fffff00f9f73f73f0004464777
000000000000000000fffff000ffff7ff000fffff00000fffff000fff77ff000fffff0000004640000fff77ff000fffff000000444000fffffffff0040467770
000000000000000004466440000fffff00044664400004466440000fffff00004464000000446400000fffff0000d444000000d4440000fff77ff000f0477770
00000000000000004046640400446644004046640400404664040004464000004464dd00004464d0000d44400000d444400000d444f0000fffff0d0000777700
0000000000000000f046640f0404664040f046640f00f046640f0040464dd0004464000000fdcc0000d04444f000d4440f0000dccd00044466ddd00000777700
000000000000000000cccc000f0cccc0f000cccc000000cccc0000f0dcc00000fdcc0000000d0c0000d0ccd00000dccd0000000c0d00f004ccd0000000777000
000000000000000000c00c00000c00c00000c00c000000c00c00000d000c00000d00c000000d0c00000c000d00000c00d000000c0d00000c000d000007777000
000000000000000000400400000400400000400400000040040000d0000040000d004000000d040000400000d0000400d00000040d000040000d000007070000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000999999009000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000999999990000000000000000000000
0999999090000000000000000000000000000000000000000000000000000000000000000000000000000000000000000999ffff900000000000000999999009
099999999000099999909009999990900999999090000000000000009999990900099999909000999999090000000000099ffffff00000000000000999999990
999ffff900000999999990099999999009999999900009999990900099999999000999999990009999999900000000000f9f73f73f000099999909999ffff900
99ffffff0000999ffff900999ffff900999ffff9000009999999900999ffff9000999ffff9000999ffff9000000000000fffffffff0f009999999999ffffff00
f9f73f73f00099ffffff0099ffffff0099ffffff0000999ffff900099ffffff00099ffffff00099ffffff0000000000000fff77ff0400999ffff90f9f73f73f0
fffffffff000f9f73f73f0f9fffffff0f9f73f73f00099ffffff000f9f73f73f00f9fffffff00f9f73f73f0000000000000fffff4400099ffffff0fffffffff0
0fff77ff0000fffffffff0fffffffff0fffffffff000f9f73f73f00fffffffff00fffffffff00fffffffff00000000000000446400000f9f73f73f0fff77ff00
00fffff000000ffff7ff000fff77ff000fff77ff0000fffffffff000ffff7ff0000fff77ff0000fff77ff000000000000004046400000fffffffff00fffff000
004466440000ddfffff000ddfffff000ddfffff000000fff77ff00044fffff000044fffff000044fffff000000000000000f0464000000fff77ff00446644000
040446604f0d00444444fd00444444fd00444444f000d4fffff000f0446ddddd0f0446ddddd0f0446ddddd000000000000000ccc0000000fffff0f4046640400
004f466600000444000000044400000004440000000d44400000000046d0000000046d0000000046d00000000000000000000d00c0000444664440f046640f00
00004ccc000044d000000044d000000044d0000000044d04f0000004cd000000004cd000000004cd000000000000000000000d040000f004cc400000cccc0000
0000c000c00c000d00000c000d00000c000d000000c000d0000000c000d000000c000d000000c000d0000000000000000000d0000000000c000c0000c00c0000
000040000440000d000040000d000040000d0000040000d00000040000d0000040000d0000040000d00000000000000000000000000000400004000040040000
